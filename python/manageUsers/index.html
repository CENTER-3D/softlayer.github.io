<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Manage Users - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/python/manageUsers/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>
    <script src="https://sldn.softlayer.com/js/fontawesome-all.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88235803-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>August 8, 2018<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_User_Customer">SoftLayer_User_Customer</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest">SoftLayer_Virtual_Guest</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Account">SoftLayer_Account</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/ordering">ordering</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/users">users</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/permissions">permissions</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>Manage Users</h1>
                    <small>A script to create users and a script to disable users. Used mostly for setting up lab users and then cleaning up after.</small>
                </div>
				
                
				
                <p>This example is a set of scripts I&rsquo;ve used for creating and disabling users.</p>
<p>Some of this functionality is also in the <a href="https://softlayer-python.readthedocs.io/en/latest/cli/users.html">SLCLI</a> now.</p>
<h2 id="create-users">Create Users</h2>
<p>Creates a user, sets up proper permissions, sets up devices access restrictions, creates API keys and orders the user a server.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> SoftLayer.API
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_user</span>(username, password):
    user_template <span style="color:#f92672">=</span> {
        <span style="color:#e6db74">&#39;username&#39;</span>: username,
        <span style="color:#e6db74">&#39;firstName&#39;</span>: <span style="color:#e6db74">&#39;API&#39;</span>,
        <span style="color:#e6db74">&#39;lastName&#39;</span>: <span style="color:#e6db74">&#39;Learner&#39;</span>,
        <span style="color:#e6db74">&#39;email&#39;</span>: <span style="color:#e6db74">&#39;someone@somewhere.com&#39;</span>,
        <span style="color:#e6db74">&#39;companyName&#39;</span>: <span style="color:#e6db74">&#39;IBM&#39;</span>,
        <span style="color:#e6db74">&#39;address1&#39;</span>: <span style="color:#e6db74">&#39;123 api road&#39;</span>,
        <span style="color:#e6db74">&#39;city&#39;</span>: <span style="color:#e6db74">&#39;Houston&#39;</span>,
        <span style="color:#e6db74">&#39;country&#39;</span>: <span style="color:#e6db74">&#39;US&#39;</span>,
        <span style="color:#e6db74">&#39;postalCode&#39;</span>: <span style="color:#e6db74">&#39;TX 77002&#39;</span>,
        <span style="color:#e6db74">&#39;userStatusId&#39;</span>: <span style="color:#ae81ff">1001</span>,
        <span style="color:#e6db74">&#39;timezoneId&#39;</span>: <span style="color:#ae81ff">107</span>
    }
    created_user <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>createObject(
        user_template,
        password,
        password)
    <span style="color:#66d9ef">return</span> created_user

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_permissions</span>(_id):
    permissions <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>getPermissions(id<span style="color:#f92672">=</span>_id)
    <span style="color:#66d9ef">return</span> permissions

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_permissions</span>(_id, permissions):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    To get permissions correct, I take the existing permissions of a user
</span><span style="color:#e6db74">    that I already have, and set my new user&#39;s permissions to be the same
</span><span style="color:#e6db74">    with addBulkPortalPermission
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">return</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>addBulkPortalPermission(
        permissions, id<span style="color:#f92672">=</span>_id)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fix_permissions</span>(user,permissions):
    <span style="color:#75715e"># I only want users to have access to this one host</span>
    virtualGuestId <span style="color:#f92672">=</span> <span style="color:#ae81ff">22334455</span>
    t <span style="color:#f92672">=</span> user[<span style="color:#e6db74">&#39;id&#39;</span>]
    set_permissions(user[<span style="color:#e6db74">&#39;id&#39;</span>], permissions)
    client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>removeAllVirtualAccessForThisUser(id<span style="color:#f92672">=</span>t)
    client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>removeAllHardwareAccessForThisUser(id<span style="color:#f92672">=</span>t)
    client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>addApiAuthenticationKey(id<span style="color:#f92672">=</span>t)
    client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>addVirtualGuestAccess(virtualGuestId,id<span style="color:#f92672">=</span>t)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">orderUserServer</span>(user, apiKey):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Orders a server as the newly created user. 
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    hostname <span style="color:#f92672">=</span> user <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;-lab-server&#34;</span>
    guest <span style="color:#f92672">=</span> {}
    guest[<span style="color:#e6db74">&#39;startCpus&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    guest[<span style="color:#e6db74">&#39;maxMemory&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1024</span>
    guest[<span style="color:#e6db74">&#39;localDiskFlag&#39;</span>] <span style="color:#f92672">=</span> False
    guest[<span style="color:#e6db74">&#39;hostname&#39;</span>] <span style="color:#f92672">=</span> hostname
    guest[<span style="color:#e6db74">&#39;domain&#39;</span>] <span style="color:#f92672">=</span> user <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.lablayer.info&#34;</span>
    guest[<span style="color:#e6db74">&#39;hourlyBillingFlag&#39;</span>] <span style="color:#f92672">=</span> True
    guest[<span style="color:#e6db74">&#39;datacenter&#39;</span>] <span style="color:#f92672">=</span> {}
    guest[<span style="color:#e6db74">&#39;datacenter&#39;</span>][<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;tok02&#39;</span>
    guest[<span style="color:#e6db74">&#39;blockDeviceTemplateGroup&#39;</span>] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;globalIdentifier&#39;</span>: <span style="color:#e6db74">&#34;6c64f59a-edeb-4ba4-b992-d04972597357&#34;</span>}
    userClient <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client(
        username <span style="color:#f92672">=</span> user,
        api_key <span style="color:#f92672">=</span> apiKey )
    result <span style="color:#f92672">=</span> userClient[<span style="color:#e6db74">&#39;Virtual_Guest&#39;</span>]<span style="color:#f92672">.</span>createObject(guest)
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Added server id: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">  ( </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> )&#34;</span> <span style="color:#f92672">%</span> (result[<span style="color:#e6db74">&#39;id&#39;</span>],result[<span style="color:#e6db74">&#39;fullyQualifiedDomainName&#39;</span>]) 
    <span style="color:#66d9ef">return</span>
   

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    <span style="color:#f92672">import</span> argparse
    argsparse <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(description<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Number of users&#39;</span>)
    argsparse<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;--num-users&#39;</span>, dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;num_users&#39;</span>, type<span style="color:#f92672">=</span>int,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Number of users to provision.&#39;</span>)
    argsparse<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;--offset&#39;</span>, dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;offset&#34;</span>, type<span style="color:#f92672">=</span>int,
                           default<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Username offset&#39;</span>)
    argsparse<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;--prefix&#39;</span>,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Username prefix&#39;</span>, default<span style="color:#f92672">=</span>False)
    args <span style="color:#f92672">=</span> argsparse<span style="color:#f92672">.</span>parse_args()

    <span style="color:#75715e">##### CHANGE THESE ##########</span>
    template_user_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">123456</span>
    password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;APAsswordGoes!!!H3r3&#39;</span> 

    client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
    
    userPerms <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>getPermissions(id<span style="color:#f92672">=</span>template_user_id)
   
    start_user_num <span style="color:#f92672">=</span> args<span style="color:#f92672">.</span>offset

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(args<span style="color:#f92672">.</span>num_users):
        target_username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (args<span style="color:#f92672">.</span>prefix,start_user_num)
        <span style="color:#66d9ef">try</span>:
            new_user <span style="color:#f92672">=</span> create_user(target_username,password)
            fix_permissions(new_user,userPerms)
            client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>addApiAuthenticationKey(id<span style="color:#f92672">=</span>new_user[<span style="color:#e6db74">&#39;id&#39;</span>])

        <span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> error:
            <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">            If the user already exists, an exception is thrown. 
</span><span style="color:#e6db74">            Just reset their permissions and continue on.
</span><span style="color:#e6db74">            &#34;&#34;&#34;</span>
            oFilter <span style="color:#f92672">=</span> {}
            oFilter[<span style="color:#e6db74">&#39;users&#39;</span>] <span style="color:#f92672">=</span> {}
            oFilter[<span style="color:#e6db74">&#39;users&#39;</span>][<span style="color:#e6db74">&#39;username&#39;</span>] <span style="color:#f92672">=</span> {}
            oFilter[<span style="color:#e6db74">&#39;users&#39;</span>][<span style="color:#e6db74">&#39;username&#39;</span>][<span style="color:#e6db74">&#39;operation&#39;</span>] <span style="color:#f92672">=</span> target_username
            new_user <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;Account&#39;</span>]<span style="color:#f92672">.</span>getUsers(filter<span style="color:#f92672">=</span>oFilter)[<span style="color:#ae81ff">0</span>]
            fix_permissions(new_user,userPerms)

        newApiKey <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>getApiAuthenticationKeys(id<span style="color:#f92672">=</span>new_user[<span style="color:#e6db74">&#39;id&#39;</span>])
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;username = </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (newApiKey[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;user&#39;</span>][<span style="color:#e6db74">&#39;username&#39;</span>])
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;api_key =  </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (newApiKey[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;authenticationKey&#39;</span>])
        orderUserServer(newApiKey[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;user&#39;</span>][<span style="color:#e6db74">&#39;username&#39;</span>],newApiKey[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;authenticationKey&#39;</span>])
        start_user_num <span style="color:#f92672">=</span> start_user_num <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>


</code></pre></div><h2 id="disable-users">Disable Users</h2>
<p>Disable user, changes their password, cancels their servers, and removes any sshKeys</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> SoftLayer.API
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_target_users</span>(prefix):
    _filter <span style="color:#f92672">=</span> {
        <span style="color:#e6db74">&#39;users&#39;</span>: {
            <span style="color:#e6db74">&#39;username&#39;</span>: {
                <span style="color:#e6db74">&#39;operation&#39;</span>: <span style="color:#e6db74">&#39;*= </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (prefix)
            }
        }
    }
    _mask <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mask[id,username]&#34;</span>
    _users <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;Account&#39;</span>]<span style="color:#f92672">.</span>getUsers(filter<span style="color:#f92672">=</span>_filter, mask<span style="color:#f92672">=</span>_mask)
    <span style="color:#66d9ef">return</span> _users

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_target_keys</span>(prefix):
    _filter <span style="color:#f92672">=</span> {
        <span style="color:#e6db74">&#39;sshKeys&#39;</span>: {
            <span style="color:#e6db74">&#39;label&#39;</span>: {
                <span style="color:#e6db74">&#39;operation&#39;</span>: <span style="color:#e6db74">&#39;*= </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (prefix)
            }
        }
    }

    _mask <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mask[id,label]&#34;</span>
    _users <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;Account&#39;</span>]<span style="color:#f92672">.</span>getSshKeys(filter<span style="color:#f92672">=</span>_filter, mask<span style="color:#f92672">=</span>_mask)
    <span style="color:#66d9ef">return</span> _users

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_result</span>(result, thing):
    <span style="color:#66d9ef">if</span> result <span style="color:#f92672">==</span> True:
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;OK&#34;</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;ERROR: &#34;</span>
        pp(thing)
    <span style="color:#66d9ef">return</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    <span style="color:#f92672">import</span> argparse
    argsparse <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser(description<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Number of users&#39;</span>)
    argsparse<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;--prefix&#39;</span>,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Username prefix&#39;</span>, default<span style="color:#f92672">=</span>False)
    argsparse<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;--password&#39;</span>,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;New Password&#39;</span>, default<span style="color:#f92672">=</span>False)
 
    args <span style="color:#f92672">=</span> argsparse<span style="color:#f92672">.</span>parse_args()

    client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
  
    users <span style="color:#f92672">=</span> get_target_users(args<span style="color:#f92672">.</span>prefix)

    <span style="color:#66d9ef">for</span> user <span style="color:#f92672">in</span> users:
        password <span style="color:#f92672">=</span>  args<span style="color:#f92672">.</span>password
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;User: &#39;</span> <span style="color:#f92672">+</span> user[<span style="color:#e6db74">&#39;username&#39;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; Password: &#39;</span> <span style="color:#f92672">+</span> password 
        <span style="color:#75715e"># status 1021 disables the user</span>
        template <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#39;id&#39;</span>: user[<span style="color:#e6db74">&#39;id&#39;</span>],
            <span style="color:#e6db74">&#39;userStatusId&#39;</span>: <span style="color:#ae81ff">1021</span>
        }

        <span style="color:#75715e"># Cancel any servers the user created</span>
        servers <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>getVirtualGuests(id<span style="color:#f92672">=</span>user[<span style="color:#e6db74">&#39;id&#39;</span>])
        result <span style="color:#f92672">=</span> True
        <span style="color:#66d9ef">for</span> virt <span style="color:#f92672">in</span> servers: 
            <span style="color:#75715e"># the &#34;,&#34; and the end of print removes the automatic newline</span>
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">Canceling host... &#34;</span> <span style="color:#f92672">+</span> virt[<span style="color:#e6db74">&#39;fullyQualifiedDomainName&#39;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; (&#34;</span> <span style="color:#f92672">+</span> str(virt[<span style="color:#e6db74">&#39;id&#39;</span>]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>),
            <span style="color:#66d9ef">try</span>:
                result <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;Virtual_Guest&#39;</span>]<span style="color:#f92672">.</span>deleteObject(id<span style="color:#f92672">=</span>virt[<span style="color:#e6db74">&#39;id&#39;</span>])
                print_result(result,virt)
            <span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> error:
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">Exception, host might already be canceling...&#34;</span>)
                pp(error)

        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">Changing password for...&#34;</span> <span style="color:#f92672">+</span> user[<span style="color:#e6db74">&#39;username&#39;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; (&#34;</span> <span style="color:#f92672">+</span> str(user[<span style="color:#e6db74">&#39;id&#39;</span>]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>),
        result <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;User_Customer&#39;</span>]<span style="color:#f92672">.</span>updatePassword(password, id<span style="color:#f92672">=</span>user[<span style="color:#e6db74">&#39;id&#39;</span>])
        print_result(result,user)
 
    sshkeys <span style="color:#f92672">=</span> get_target_keys(args<span style="color:#f92672">.</span>prefix)
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;SSH Key Removal&#39;</span>
    <span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> sshkeys:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Deleting key... &#34;</span> <span style="color:#f92672">+</span> key[<span style="color:#e6db74">&#39;label&#39;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; (&#34;</span> <span style="color:#f92672">+</span> str(key[<span style="color:#e6db74">&#39;id&#39;</span>]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>),
        result <span style="color:#f92672">=</span> client[<span style="color:#e6db74">&#39;SoftLayer_Security_Ssh_Key&#39;</span>]<span style="color:#f92672">.</span>deleteObject(id<span style="color:#f92672">=</span>key[<span style="color:#e6db74">&#39;id&#39;</span>])
        print_result(result,key)

    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;Complete&#39;</span>
</code></pre></div><h2 id="users-statuses">Users Statuses</h2>
<p>The following statuses are available for users:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ slcli call-api SoftLayer_User_Customer_Status getAllObjects
ID    KeyName         Description
1001  ACTIVE          Active
1002  DISABLED        Disabled
1003  INACTIVE        Inactive
1004  PENDING         Pending
1005  SUSPENDED       Suspended
1006  IAMID_INVALID   IAMid Invalid
1021  CANCEL_PENDING  cancel_pending
1022  VPN_ONLY        VPN Only

</code></pre></div><p>When a user is set to CANCEL_PENDING, they will now show up in the API results or portal, however the users will still technically exist in the database. So if you try to create another user with the same username, you may get an error.</p>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20python%20-%20Manage%20Users&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fpython%2fmanageUsers%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>
