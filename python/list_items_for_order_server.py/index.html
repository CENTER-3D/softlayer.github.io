<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>list_items_for_order_server.py - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/python/list_items_for_order_server.py/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>
    <script src="https://sldn.softlayer.com/js/fontawesome-all.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88235803-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>November 23, 2017<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Item">SoftLayer_Product_Item</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Location_Datacenter">SoftLayer_Location_Datacenter</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Package_Preset_Configuration">SoftLayer_Product_Package_Preset_Configuration</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Package_Order_Configuration">SoftLayer_Product_Package_Order_Configuration</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Package_Preset">SoftLayer_Product_Package_Preset</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Item_Price">SoftLayer_Product_Item_Price</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Product_Package">SoftLayer_Product_Package</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Location_Region">SoftLayer_Location_Region</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/baremetalservers">baremetalservers</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>list_items_for_order_server.py</h1>
                    <small>list_items_for_order_server.py</small>
                </div>
				
                
				
                <pre><code>&quot;&quot;&quot;
List items to order device.

The script displays the available data centers and items for a package.
Note: The displayed prices are standard prices.

Important manual pages
http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package/getObject
http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package/getItems
http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package/getConfiguration
http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package/getPresetConfigurationRequiredFlag
http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package/getActivePresets
http://sldn.softlayer.com/reference/datatypes/SoftLayer_Product_Package/
http://sldn.softlayer.com/reference/datatypes/SoftLayer_Product_Package_Preset/
http://sldn.softlayer.com/article/Object-Masks
http://sldn.softlayer.com/article/Object-Filters

License: http://sldn.softlayer.com/article/License
Author: SoftLayer Technologies, Inc. &lt;sldn@softlayer.com&gt;
&quot;&quot;&quot;

import SoftLayer

# Your SoftLayer API username and key.
API_USERNAME = 'Set-me'

# Generate one at https://control.softlayer.com/account/users
API_KEY = 'Set-me'

package_id = 200
# Set True to see the hourly prices.
# In case you see empty prices that means the item does not have an hourly price.
hourly = False

# Some packages such as the package 200 requires a preset id.
# Configure the value with &quot;&quot; in case the packages do not requires a preset id.
preset_id = 385

client = SoftLayer.create_client_from_env(username=API_USERNAME, api_key=API_KEY)
package_service = client['SoftLayer_Product_Package']


def get_all_datacenters_available_for_package(package_id, package_service):
    &quot;&quot;&quot;Get the available datacenters for a package.
        :param int package_id: The package id to get the available data centers.
        :param SoftLayer_Product_Package package_service: The SoftLayer Product Package service.
        :returns: An array SoftLayer_Location_Region.
    &quot;&quot;&quot;
    try:
        object_mask = &quot;mask[regions[keyname,description,sortOrder,&quot; \
                      &quot;location[location(SoftLayer_Location_Datacenter)[activePresaleEvents,&quot; \
                      &quot;priceGroups.id,locationAddress.country,brandCountryRestrictions[locationId, &quot; \
                      &quot;customerCountryCode]]]]]&quot;
        result = package_service.getObject(id=package_id, mask=object_mask)
        regions = []
        for item in result['regions']:
            for detail in item['location']['locationPackageDetails']:
                if detail['isAvailable'] == 1 and detail['locationId'] == item['location']['location']['id'] \
                        and detail['packageId'] == package_id:
                    regions.append(item)
    except SoftLayer.SoftLayerAPIError as e:
        print(&quot;Unable to get the data centers. \nfaultCode= %s, \nfaultString= %s&quot; % (e.faultCode, e.faultString))
        exit(0)
    return regions


def get_all_items(package_id, package_service):
    &quot;&quot;&quot;Get all the items for a package.
        :param int package_id: The package id to get the available data centers.
        :param SoftLayer_Product_Package package_service: The SoftLayer Product Package service.
        :returns: An array of SoftLayer_Product_Item.
    &quot;&quot;&quot;
    try:
        object_mask = &quot;mask[categories, prices[pricingLocationGroup, presetConfigurations]]&quot;
        items = package_service.getItems(id=package_id, mask=object_mask)
        items = sorted(items, key=lambda item: (item['description']))
    except SoftLayer.SoftLayerAPIError as e:
        print(&quot;Unable to get the items. faultCode=%s, faultString=%s&quot; % (e.faultCode, e.faultString))
        exit(0)
    return items


def get_configuration(package_service):
    &quot;&quot;&quot;Get the configuration for a package.
        :param SoftLayer_Product_Package package_service: The SoftLayer Product Package service.
        :returns: An array of SoftLayer_Product_Package_Order_Configuration.
    &quot;&quot;&quot;
    try:
        object_mask = &quot;mask[itemCategory]&quot;
        items = package_service.getConfiguration(id=package_id, mask=object_mask)
    except SoftLayer.SoftLayerAPIError as e:
        print(&quot;Unable to get the required categories. faultCode=%s, faultString=%s&quot; % (e.faultCode, e.faultString))
        exit(0)
    return items


def is_required_option(list, category_code, configurations):
    &quot;&quot;&quot;Verifies if a category is required in the configurations of the package
       In case it is not required adds the value none to the list parameter.
        :param An array of SoftLayer_Product_Item list: The list of items.
        :param string category_code: The category code to verify if it is required in the package configuration.
        :param An array of SoftLayer_Product_Package_Order_Configuration configurations:
        The configuration of the package.
        :returns: An array of SoftLayer_Product_Item.
    &quot;&quot;&quot;
    items = [conf for conf in configurations if conf['itemCategory']['categoryCode'] == category_code
             and conf['isRequired'] == 1]
    if len(items) == 0:
        none = {}
        none['description'] = &quot;None&quot;
        list.insert(0, none)
    return list


def get_filtered_items_category(items, configurations, category_code):
    &quot;&quot;&quot;Gets the items which belong to a category code.
        :param An array of SoftLayer_Product_Item items: The list of items.
        :param An array of SoftLayer_Product_Package_Order_Configuration configurations:
        The configuration of the package.
        :param string category_code: The category code to filter.
        :returns: An array of SoftLayer_Product_Item.
    &quot;&quot;&quot;
    filtered = []
    for item in items:
        categories = [category for category in item['categories'] if category['categoryCode'] == category_code]
        if len(categories) &gt; 0:
            filtered.append(item)
    filtered = is_required_option(filtered, category_code, configurations)
    return filtered


def get_standard_item_price(item):
    &quot;&quot;&quot;Gets the standard price for an item.
        :param An array of SoftLayer_Product_Item item: The item to get the standard price.
        :returns: A SoftLayer_Product_Item_Price.
    &quot;&quot;&quot;
    prices = [price for price in item['prices'] if price['locationGroupId'] == &quot;&quot;]
    # We always return the last standard price in the list.
    return prices[-1]


def display_datacenters(datacenters):
    &quot;&quot;&quot;Displays the data centers.
        :param An array SoftLayer_Location_Region datacenters: The list of regions.
    &quot;&quot;&quot;
    tab_spaces_begin = 4
    id_label = &quot;LocationId&quot;
    print(id_label + &quot; &quot; * tab_spaces_begin + &quot;DATA CENTER&quot;)
    for datacenter in datacenters:
        print(str(datacenter['location']['location']['id']) + &quot; &quot; *
              (len(id_label) - len(str(datacenter['location']['location']['id']))) + &quot; &quot; *
              tab_spaces_begin + datacenter['description'])
    print()
    print()
    return


def display_items(items, title, hourly, is_preset, price_preset):
    &quot;&quot;&quot;Displays the data centers.
        :param An array SoftLayer_Product_Item items: The list of items to display.
        :param string title: The title of the items.
        :param boolean hourly: A boolean value which indicates if the hourly prices must be displayed.
    &quot;&quot;&quot;
    tab_spaces_begin = 4
    tab_spaces_prices = 4
    tab_spaces_desc = 60
    price_id_label = &quot;PriceId&quot;
    if len(items) &gt; 0:
        if len(items) &gt; 1 or items[0]['description'] != &quot;None&quot;:
            if not hourly:
                price_label = &quot;Monthly&quot;
                price_key = &quot;recurringFee&quot;
            else:
                price_label = &quot;Hourly&quot;
                price_key = &quot;hourlyRecurringFee&quot;

            print(price_id_label + &quot; &quot; * tab_spaces_begin + title.upper() + &quot; &quot; * tab_spaces_desc + price_label +
                  &quot; &quot; * tab_spaces_prices + &quot;Setup&quot;)
            for item in items:
                if item['description'] == &quot;None&quot;:
                    print(&quot; &quot; * len(price_id_label) + &quot; &quot; * tab_spaces_begin + item['description'])
                else:
                    if not is_preset:
                        price = get_standard_item_price(item)
                    else:
                        price = price_preset
                    if price_key in price:
                        print(str(price['id']) + &quot; &quot; * (len(price_id_label) - len(str(price['id']))) + &quot; &quot;
                              * tab_spaces_begin + item['description'].strip() + &quot; &quot;
                              * (tab_spaces_desc + len(title) - len(item['description']))
                              + str(float(price[price_key])) + &quot;$&quot; + &quot; &quot;
                              * (len(price_label) - len(str(float(price[price_key]))))
                              + &quot; &quot; * tab_spaces_prices + str(float(price['setupFee'])) + &quot;$&quot;)
            print()
            print()
    return


def is_preset_required(package_id, package_service):
    &quot;&quot;&quot;Gets the preset configuration required flag.
        :param int package_id: The package id to get the available data centers.
        :param SoftLayer_Product_Package package_service:
        The SoftLayer Product Package service.
        :returns: An boolean which indicates whether preset is required.
    &quot;&quot;&quot;
    try:
        result = package_service.getPresetConfigurationRequiredFlag(id=package_id)
    except SoftLayer.SoftLayerAPIError as e:
        print(&quot;Unable to get the preset configuration required flag. \nfaultCode= %s, \nfaultString= %s&quot;
              % (e.faultCode, e.faultString))
        exit(0)
    return result


def getting_package_preset(package_id, preset_id, package_service):
    &quot;&quot;&quot;Gets a SoftLayer_Product_Package_Preset object.
        :param int package_id: The package id to get the available data centers.
        :param int preset_id: The preset id of the SoftLayer_Product_Package_Preset to get.
        :param SoftLayer_Product_Package package_service: The SoftLayer Product Package service.
        :returns: A oftLayer_Product_Package_Preset object.
    &quot;&quot;&quot;
    try:
        object_mask = &quot;mask[packageConfiguration[itemCategory],categories, &quot; \
                      &quot;configuration[price[item[prices[pricingLocationGroup]]],category]]&quot;
        object_filter = {&quot;activePresets&quot;: {&quot;id&quot;: {&quot;operation&quot;: preset_id}}}
        presets = package_service.getActivePresets(id=package_id, mask=object_mask, filter=object_filter)
        if len(presets) == 0:
            print(&quot;The configured preset id: '&quot; + str(preset_id) + &quot;' is not valid for the package id: '&quot;
                  + str(package_id) + &quot;'&quot;)
            exit(0)
    except SoftLayer.SoftLayerAPIError as e:
        print(&quot;Unable to get the active presets. \nfaultCode= %s, \nfaultString= %s&quot; % (e.faultCode, e.faultString))
        exit(0)
    return presets[0]


def get_filtered_item_preset_category(preset_configurations, category_code):
    &quot;&quot;&quot;Gets the prices for a preset configuration list which contain an arbitrary category code.
        :param SoftLayer_Product_Package_Preset_Configuration preset_configurations:
        The list of configuration in the preset.
        :param string category_code: The category code to filter.
        :returns: An array SoftLayer_Product_Item_Price.
    &quot;&quot;&quot;
    filtered = []
    for presetConfiguration in preset_configurations:
        if presetConfiguration['category']['categoryCode'] == category_code:
            filtered.append(presetConfiguration['price'])
    return filtered


def get_configurations_not_preset(preset):
    &quot;&quot;&quot;Gets the configuration list which contains the categories that can be configurable.
        :param SoftLayer_Product_Package_Preset preset: The preset to get the configuration list.
        :returns: An array of SoftLayer_Product_Package_Order_Configuration.
    &quot;&quot;&quot;
    configurations = []
    # When the package has a preset configuration only a few categories can be edited.
    # Below the list of categories which can be edited.
    allowed_list = [&quot;bandwidth&quot;, &quot;port_speed&quot;, &quot;sec_ip_addresses&quot;, &quot;pri_ipv6_addresses&quot;,
                    &quot;static_ipv6_addresses&quot;, &quot;evault&quot;, &quot;os&quot;]
    for conf in preset['packageConfiguration']:
        for allowed in allowed_list:
            if conf['itemCategory']['categoryCode'] == allowed:
                configurations.append(conf)
                break
    return configurations

# Getting the available data centers.
datacenters = get_all_datacenters_available_for_package(package_id, package_service)
# Displaying the data centers
display_datacenters(datacenters)

if not is_preset_required(package_id, package_service):
    # Getting the items in the package
    items = get_all_items(package_id, package_service)
    # Getting the configuration of the package
    configurations = get_configuration(package_id, package_service)
    configurations = sorted(configurations, key=lambda item: item['isRequired'], reverse=True)
    # Displaying the items
    for conf in configurations:
        listItems = get_filtered_items_category(items, configurations, conf['itemCategory']['categoryCode'])
        display_items(listItems, conf['itemCategory']['name'], hourly, False, &quot;&quot;)
else:
    # Getting the preset configuration, these items cannot be changed in the order.
    # Review http://sldn.softlayer.com/reference/datatypes/SoftLayer_Product_Package_Preset for more information.
    preset = getting_package_preset(package_id, preset_id, package_service)
    print(&quot;*************************************   PRESET CONFIGURATION   *************************************&quot;)
    print(&quot;&quot;)
    for conf in preset['packageConfiguration']:
        listConfiguredItems = get_filtered_item_preset_category(preset['configuration'],
                                                                conf['itemCategory']['categoryCode'])
        items = []
        if len(listConfiguredItems) &gt; 0:
            items.append(listConfiguredItems[0]['item'])
            display_items(items, conf['itemCategory']['categoryCode'], hourly, True, listConfiguredItems[0])
    # Getting the items which can be configured in the order.
    configurations = get_configurations_not_preset(preset)
    # Getting the items in the package
    items = get_all_items(package_id, package_service)
    print(&quot;*************************************   CONFIGURABLE ITEMS   *************************************&quot;)
    print(&quot;&quot;)
    # Displaying the items
    for conf in configurations:
        listItems = get_filtered_items_category(items, configurations, conf['itemCategory']['categoryCode'])
        display_items(listItems, conf['itemCategory']['name'], hourly, False, &quot;&quot;)

</code></pre>
            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20python%20-%20list_items_for_order_server.py&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fpython%2flist_items_for_order_server.py%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>
