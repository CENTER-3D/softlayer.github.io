<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Transient Guests - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/article/TransientGuests/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>
    <script src="https://sldn.softlayer.com/js/fontawesome-all.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88235803-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>January 15, 2020<br></h4>
            </div>
        </div>
        <div class="col-md-9">
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/virtualguest">virtualguest</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/transient">transient</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/ordering">ordering</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-12">
            <div class="well well-sm article" style="word-wrap: break-word;">
                <div class="article-title">
                    <h1>Transient Guests</h1>
                    <small>Examples on how to create Transient guests, and working with web hooks.</small>
                </div>
                
                
                
                <h1 id="introduction">Introduction</h1>
<p>If you are not familiar with the basics of Transient Guests, please see the following documentation.</p>
<ul>
<li><a href="https://cloud.ibm.com/docs/vsi?topic=virtual-servers-about-vs-transient">Transient virtual servers</a></li>
<li><a href="https://cloud.ibm.com/docs/vsi?topic=virtual-servers-configuring-notifications-for-reclaims-of-transient-virtual-servers">Configuring notifications for reclaims of transient virtual servers</a></li>
</ul>
<p>This article will show how to use the SoftLayer-Python library to create a Transient Guest with <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/createObject/">SoftLayer_Virtual_Guest::createObject()</a>, set the webhook URI with <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/setTransientWebhook/">SoftLayer_Virtual_Guest::setTransientWebhook()</a>, and how to test it with <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/sendTestReclaimScheduledAlert/">SoftLayer_Virtual_Guest::sendTestReclaimScheduledAlert()</a>. Not covered is how to do something useful with the data received, that is left as an exercise for the reader.</p>
<h2 id="example-setup">Example Setup</h2>
<p>To start off, I like to use the following example format. We start with a class, and add methods to it for various actions we need to take. The python file will have a <code>if __name__ == &quot;__main__&quot;:</code> block so that it can be executed as a shell script for easy testing. At the end of the article will be the full file. Each section will break down what is going on with each function of the class.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp
<span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> string

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">transient</span>():

    <span style="color:#66d9ef">def</span> __init__(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Init the SoftLayer Client.
</span><span style="color:#e6db74">        
</span><span style="color:#e6db74">        the debugger part lets you easily reproduce the exact API calls made.
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
        debugger <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>DebugTransport(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport)
        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport <span style="color:#f92672">=</span> debugger

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">debug</span>(self):
        <span style="color:#66d9ef">for</span> call <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>get_last_calls():
            <span style="color:#66d9ef">print</span>(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>print_reproduceable(call))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">randomString</span>(self, stringLength<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>):
        <span style="color:#e6db74">&#34;&#34;&#34;Generate a random string of fixed length.
</span><span style="color:#e6db74">        
</span><span style="color:#e6db74">        I use this to make random hostnames.
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        letters <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_lowercase
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(random<span style="color:#f92672">.</span>choice(letters) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(stringLength))

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    main <span style="color:#f92672">=</span> transient()
    main<span style="color:#f92672">.</span>debug()
</code></pre></div><h1 id="order-options">Order Options</h1>
<p>This example will showcase how to create a Virtual Guest with the createObject method. For more information on the details about ordering the following might also be helpful <a href="https://sldn.softlayer.com/tags/ordering/">Ordering examples</a>.</p>
<p>The following methods will print out some of the basic options for creating a new transient guest.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printFlavors</span>(self, flavors):
        <span style="color:#e6db74">&#34;&#34;&#34;Flavors need to have the attribute transientGuestFlag == True&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== FLAVORS ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Flavor, Hourly Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> flavors:
            <span style="color:#66d9ef">if</span> option[<span style="color:#e6db74">&#39;template&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;transientGuestFlag&#39;</span>, False):
                flavor <span style="color:#f92672">=</span> option[<span style="color:#e6db74">&#39;flavor&#39;</span>]
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}&#34;</span><span style="color:#f92672">.</span>format(flavor[<span style="color:#e6db74">&#39;keyName&#39;</span>], flavor[<span style="color:#e6db74">&#39;totalMinimumHourlyFee&#39;</span>]))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printOS</span>(self, operatingSystems):
        <span style="color:#e6db74">&#34;&#34;&#34;Only list operating systems billed hourly&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== OPERATING SYSTEMS ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;KeyName, Description, Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> operatingSystems:
            <span style="color:#66d9ef">if</span> option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>, False):
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}, {}&#34;</span><span style="color:#f92672">.</span>format(
                    option[<span style="color:#e6db74">&#39;template&#39;</span>][<span style="color:#e6db74">&#39;operatingSystemReferenceCode&#39;</span>],
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;item&#39;</span>][<span style="color:#e6db74">&#39;description&#39;</span>],
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>]
                ))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printDisk</span>(self, disks):
        <span style="color:#e6db74">&#34;&#34;&#34;Disks with device == 2 are the ones that can be ordered as additional disks
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">        disk 0 is primary
</span><span style="color:#e6db74">        disk 1 is SWAP
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== Disks ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Size, Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> disks:
            device <span style="color:#f92672">=</span> option[<span style="color:#e6db74">&#39;template&#39;</span>][<span style="color:#e6db74">&#39;blockDevices&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;device&#39;</span>] 
            <span style="color:#66d9ef">if</span> device <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;dedicatedHostInstanceFlag&#39;</span>, False):
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}&#34;</span><span style="color:#f92672">.</span>format(
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;item&#39;</span>][<span style="color:#e6db74">&#39;description&#39;</span>], 
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>]

</code></pre></div><h3 id="output">Output</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Calling: SoftLayer_Virtual_Guest::getCreateObjectOptions(id=None, mask=&#39;&#39;, filter=&#39;None&#39;, args=(), limit=None, offset=None))
====== OPERATING SYSTEMS ======
KeyName, Description, Cost
CENTOS_LATEST, CentOS - Latest, 0
CENTOS_LATEST_64, CentOS - Latest (64 bit), 0
CENTOS_7_64, CentOS 7.x - Minimal Install (64 bit), 0
====== FLAVORS ======
Flavor, Hourly Cost
B1_1X2X25, 0.0133
B1_1X2X100, 0.0293
B1_1X4X25, 0.0208
====== Disks ======
Size, Cost
10 GB (SAN), .007
20 GB (SAN), .009
25 GB (SAN), .01
</code></pre></div><h3 id="rest-api-call">REST API Call</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">curl -u $SL_USER:$SL_APIKEY  &#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/getCreateObjectOptions.json&#39;
</code></pre></div><h1 id="creation">Creation</h1>
<p>Given how many options there are for creating guests, it is challenging to make an easy to read example, but hopefully this helps. I highly recommend using the build in <a href="https://softlayer-python.readthedocs.io/en/latest/api/managers/vs/#SoftLayer.managers.vs.VSManager.order_guest">VSManager.order_guest()</a> method as that is a little more flexible. This example does basically the same thing though, just hard-coded a bit to be more readable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">createTransient</span>(self, hostname, webhook_uri, secret):
        <span style="color:#e6db74">&#34;&#34;&#34;Creates a transient guest
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">        This example directly uses SooftLayer_Virtual_Guest::createObject, but using VSManager.order_guest()
</span><span style="color:#e6db74">        might be easier for most users.
</span><span style="color:#e6db74">        https://softlayer-api-python-client.readthedocs.io/en/latest/api/managers/vs/#SoftLayer.managers.vs.VSManager.order_guest
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>

        domain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ibm.com&#39;</span> <span style="color:#75715e"># pick a domain</span>
        datacenter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dal13&#39;</span> <span style="color:#75715e"># pick a dc</span>
        os_keyname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;UBUNTU_LATEST_64&#39;</span> <span style="color:#75715e"># from options in printOS</span>
        pub_network_vlan_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">12345</span>
        pub_subnet_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">54321</span>
        pri_network_vlan_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">112233</span>
        pri_subnet_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">332211</span>
        sg_allow_all_tcp_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">999999</span>
        sg_allow_all_udp_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">888888</span>
        post_install_uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://pastebin.com/raw/62wrEKuW&#39;</span> <span style="color:#75715e"># needs to be https to be executed</span>
        flavor_keyname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C1_1X1X100&#39;</span> <span style="color:#75715e"># from printFlavors</span>
        ssh_keys <span style="color:#f92672">=</span> [{<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#ae81ff">7777777</span>}] <span style="color:#75715e"># ID of sshkey</span>

        <span style="color:#75715e"># https://sldn.softlayer.com/reference/datatypes/SoftLayer_Virtual_Guest/</span>
        template <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#39;hostname&#39;</span>: hostname,
            <span style="color:#e6db74">&#39;domain&#39;</span>: domain,
            <span style="color:#e6db74">&#39;datacenter&#39;</span>: {<span style="color:#e6db74">&#39;name&#39;</span>:datacenter}, 
            <span style="color:#e6db74">&#39;hourlyBillingFlag&#39;</span>: True, <span style="color:#75715e"># Has to be True for transient</span>
            <span style="color:#e6db74">&#39;operatingSystemReferenceCode&#39;</span>: os_keyname,
            <span style="color:#e6db74">&#39;networkComponents&#39;</span>: [{<span style="color:#e6db74">&#39;maxSpeed&#39;</span>:<span style="color:#ae81ff">1000</span>}], <span style="color:#75715e"># 10, 100, 1000</span>
            <span style="color:#e6db74">&#39;blockDevices&#39;</span>: [
                {<span style="color:#e6db74">&#39;device&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;diskImage&#39;</span>: {<span style="color:#e6db74">&#39;capacity&#39;</span>: <span style="color:#ae81ff">30</span>}} <span style="color:#75715e"># optional additional disks.</span>
            ],
            <span style="color:#e6db74">&#39;sshKeys&#39;</span>: ssh_keys,  <span style="color:#75715e"># optional</span>
            <span style="color:#75715e"># https://sldn.softlayer.com/reference/datatypes/SoftLayer_Virtual_Guest_SupplementalCreateObjectOptions/</span>
            <span style="color:#e6db74">&#39;supplementalCreateObjectOptions&#39;</span>: {
                <span style="color:#e6db74">&#39;flavorKeyName&#39;</span>: flavor_keyname,
                <span style="color:#e6db74">&#39;postInstallScriptUri&#39;</span>:  post_install_uri  <span style="color:#75715e"># optional</span>
            },
            <span style="color:#e6db74">&#39;transientGuestFlag&#39;</span>: True,
            <span style="color:#e6db74">&#39;primaryBackendNetworkComponent&#39;</span> : { <span style="color:#75715e"># optional</span>
                <span style="color:#e6db74">&#39;networkVlan&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pri_network_vlan_id, <span style="color:#e6db74">&#39;primarySubnet&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pri_subnet_id}}
            },
            <span style="color:#e6db74">&#39;primaryNetworkComponent&#39;</span>: { <span style="color:#75715e"># optional</span>
                <span style="color:#e6db74">&#39;networkVlan&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pub_network_vlan_id, <span style="color:#e6db74">&#39;primarySubnet&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pub_subnet_id}},
                <span style="color:#e6db74">&#39;securityGroupBindings&#39;</span>: [ <span style="color:#75715e"># optional</span>
                    {<span style="color:#e6db74">&#39;securityGroup&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: sg_allow_all_tcp_id}}, {<span style="color:#e6db74">&#39;securityGroup&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: sg_allow_all_udp_id}}
                ]
            },
            <span style="color:#e6db74">&#39;userData&#39;</span>: [{<span style="color:#e6db74">&#39;value&#39;</span>:<span style="color:#e6db74">&#34;Just some random data, you can put anything here you want!&#34;</span>}] <span style="color:#75715e"># optional</span>
        }

        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;createObject&#39;</span>, template)
        pp(result)
        <span style="color:#75715e"># Webhook HAS to be set AFTER the guest is created.</span>
        self<span style="color:#f92672">.</span>setWebHook(result[<span style="color:#e6db74">&#39;id&#39;</span>], webhook_uri, secret)
        <span style="color:#66d9ef">return</span> result
</code></pre></div><h3 id="rest-api-call-1">REST API Call</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Virtual_Guest::createObject
curl -u $SL_USER:$SL_APIKEY -X POST -d \ 
&#39;{&#34;parameters&#34;: [{&#34;hostname&#34;: &#34;TRXcgezuyxunytl&#34;, &#34;domain&#34;: &#34;ibm.com&#34;, &#34;datacenter&#34;: {&#34;name&#34;: &#34;dal13&#34;}, &#34;hourlyBillingFlag&#34;: true, &#34;operatingSystemReferenceCode&#34;: &#34;UBUNTU_LATEST_64&#34;, &#34;networkComponents&#34;: [{&#34;maxSpeed&#34;: 1000}], &#34;blockDevices&#34;: [{&#34;device&#34;: 2, &#34;diskImage&#34;: {&#34;capacity&#34;: 30}}], &#34;sshKeys&#34;: [{&#34;id&#34;: 87634}], &#34;supplementalCreateObjectOptions&#34;: {&#34;flavorKeyName&#34;: &#34;C1_1X1X100&#34;, &#34;postInstallScriptUri&#34;: &#34;https://pastebin.com/raw/62wrEKuW&#34;}, &#34;transientGuestFlag&#34;: true, &#34;primaryBackendNetworkComponent&#34;: {&#34;networkVlan&#34;: {&#34;id&#34;: 2068355, &#34;primarySubnet&#34;: {&#34;id&#34;: 1509335}}}, &#34;primaryNetworkComponent&#34;: {&#34;networkVlan&#34;: {&#34;id&#34;: 2068353, &#34;primarySubnet&#34;: {&#34;id&#34;: 1499537}}, &#34;securityGroupBindings&#34;: [{&#34;securityGroup&#34;: {&#34;id&#34;: 128323}}, {&#34;securityGroup&#34;: {&#34;id&#34;: 128321}}]}, &#34;userData&#34;: [{&#34;value&#34;: &#34;Just some random data, you can put anything here you want!&#34;}]}]}&#39; \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/createObject.json&#39;

# Virtual_Guest::setTransientWebhook
curl -u $SL_USER:$SL_APIKEY -X POST -d \
&#39;{&#34;parameters&#34;: [&#34;http://169.62.147.163/tesdfdsfst&#34;, &#34;MySecret123&#34;]}&#39; \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/95433052/setTransientWebhook.json&#39;
</code></pre></div><h1 id="web-hooks">Web Hooks</h1>
<p>The webhook has two parts. The URI, and the Secret. The URI is simply the location to send the cancellation notification. The Secret is used to create a Authorization Header hash so you can verify it was IBM Cloud who sent you the notification.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setWebHook</span>(self, guest_id, url, secret):
        <span style="color:#e6db74">&#34;&#34;&#34;Sets the webhook&#34;&#34;&#34;</span>
        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;setTransientWebhook&#39;</span>, url, secret, id<span style="color:#f92672">=</span>guest_id)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWebHook</span>(self, guest_id):
        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;getTransientWebhookURI&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        pp(result)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">delWebHook</span>(self, guest_id):
        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;deleteTransientWebhook&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        pp(result)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testWebHook</span>(self, guest_id):
        <span style="color:#e6db74">&#34;&#34;&#34;Will send a test reclaim message to the TransientWebhookURI
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">        SoftLayer_Virtual_Guest::sendTestReclaimScheduledAlert return None
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        <span style="color:#66d9ef">try</span>:
            self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;sendTestReclaimScheduledAlert&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        <span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>SoftLayerAPIError:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{} doesn&#39;t have a webhook set!&#34;</span><span style="color:#f92672">.</span>format(guest_id))
</code></pre></div><h3 id="the-cancellation-notification">The Cancellation Notification</h3>
<p>When you make an API call to <code>sendTestReclaimScheduledAlert</code>, OR the transient Virtual Guest is reclaimed, a HTTP request will get sent to the TransientWebhookURI. That request will look something like this:</p>
<p>Here I&rsquo;m using <a href="https://en.wikipedia.org/wiki/Netcat">nc</a> to catch the requests.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># nc -lk 0.0.0.0 80
POST /tesdfdsfst HTTP/1.1
Host: 169.62.147.163
Content-Type: application/json
User-Agent: IBM Cloud Webhook Service
Authorization: AAAAAAA11111111111111111111111yNzMwNjA4YjAwMjU0MjUzM2MwMGE1MjljOTAxNDlkM2M1NjgyODdkYg==
X-IBM-Nonce: 111111116f3d430799139a0a28450000
Content-Length: 200

{&#34;id&#34;:&#34;95430736&#34;,&#34;serviceName&#34;:&#34;SoftLayer_Virtual_Guest&#34;,&#34;event&#34;:&#34;reclaim-scheduled-test&#34;,&#34;timestamp&#34;:1579124035,&#34;link&#34;:&#34;https:\/\/api.softlayer.com\/rest\/v3\/SoftLayer_Virtual_Guest\/95430736.json&#34;}
HEAD /robots.txt HTTP/1.0
</code></pre></div><p>Compared to a REAL reclaim event.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># nc -lk 0.0.0.0 80
POST /tesdfdsfst HTTP/1.1
Host: 169.62.147.163
Content-Type: application/json
User-Agent: IBM Cloud Webhook Service
Authorization: AAAAAAA11111111111111111111111yNzMwNjA4YjAwMjU0MjUzM2MwMGE1MjljOTAxNDlkM2M1NjgyODdkYg==
X-IBM-Nonce: 111111116f3d430799139a0a28450000
Content-Length: 222

{&#34;id&#34;:&#34;95433052&#34;,&#34;serviceName&#34;:&#34;SoftLayer_Virtual_Guest_Citrix_XenServer_Version41&#34;,&#34;event&#34;:&#34;reclaim-scheduled&#34;,&#34;timestamp&#34;:1579127296,&#34;link&#34;:&#34;https:\/\/api.softlayer.com\/rest\/v3\/SoftLayer_Virtual_Guest\/95433052.json&#34;}
</code></pre></div><h3 id="rest-api-calls">REST API Calls</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Virtual_Guest::setTransientWebhook
curl -u $SL_USER:$SL_APIKEY -X POST  -d \
&#39;{&#34;parameters&#34;: [&#34;http://169.62.147.163/tesdfdsfst&#34;, &#34;MySecret123&#34;]}&#39; \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/95433052/setTransientWebhook.json&#39;

# Virtual_Guest::getTransientWebhookURI
curl -u $SL_USER:$SL_APIKEY \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/95433052/getTransientWebhookURI.json&#39;

# Virtual_Guest::sendTestReclaimScheduledAlert
curl -u $SL_USER:$SL_APIKEY  \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/95433052/sendTestReclaimScheduledAlert.json&#39;

# Virtual_Guest::deleteTransientWebhook
curl -u $SL_USER:$SL_APIKEY \
&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Virtual_Guest/95433052/deleteTransientWebhook.json&#39;
</code></pre></div><h1 id="full-example">Full Example</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">@package examples 
</span><span style="color:#e6db74">@author Christopher Gallo
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
<span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp
<span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> string

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">transient</span>():

    <span style="color:#66d9ef">def</span> __init__(self):

        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
        debugger <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>DebugTransport(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport)
        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport <span style="color:#f92672">=</span> debugger


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transientOptions</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">        Formats results from services/SoftLayer_Virtual_Guest::getCreateObjectOptions()
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>

        options <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;getCreateObjectOptions&#39;</span>)
        self<span style="color:#f92672">.</span>printOS(options<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;operatingSystems&#39;</span>))
        self<span style="color:#f92672">.</span>printFlavors(options<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;flavors&#39;</span>))
        self<span style="color:#f92672">.</span>printDisk(options<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;blockDevices&#39;</span>))


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printFlavors</span>(self, flavors):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== FLAVORS ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Flavor, Hourly Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> flavors:
            <span style="color:#66d9ef">if</span> option[<span style="color:#e6db74">&#39;template&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;transientGuestFlag&#39;</span>, False):
                flavor <span style="color:#f92672">=</span> option[<span style="color:#e6db74">&#39;flavor&#39;</span>]
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}&#34;</span><span style="color:#f92672">.</span>format(flavor[<span style="color:#e6db74">&#39;keyName&#39;</span>], flavor[<span style="color:#e6db74">&#39;totalMinimumHourlyFee&#39;</span>]))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printOS</span>(self, operatingSystems):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== OPERATING SYSTEMS ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;KeyName, Description, Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> operatingSystems:
            <span style="color:#66d9ef">if</span> option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>, False):
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}, {}&#34;</span><span style="color:#f92672">.</span>format(
                    option[<span style="color:#e6db74">&#39;template&#39;</span>][<span style="color:#e6db74">&#39;operatingSystemReferenceCode&#39;</span>],
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;item&#39;</span>][<span style="color:#e6db74">&#39;description&#39;</span>],
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>]
                ))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printDisk</span>(self, disks):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====== Disks ======&#34;</span>)
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Size, Cost&#34;</span>)
        <span style="color:#66d9ef">for</span> option <span style="color:#f92672">in</span> disks:
            device <span style="color:#f92672">=</span> option[<span style="color:#e6db74">&#39;template&#39;</span>][<span style="color:#e6db74">&#39;blockDevices&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;device&#39;</span>] 
            <span style="color:#66d9ef">if</span> device <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>]<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;dedicatedHostInstanceFlag&#39;</span>, False):
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{}, {}&#34;</span><span style="color:#f92672">.</span>format(
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;item&#39;</span>][<span style="color:#e6db74">&#39;description&#39;</span>], 
                    option[<span style="color:#e6db74">&#39;itemPrice&#39;</span>][<span style="color:#e6db74">&#39;hourlyRecurringFee&#39;</span>]
                ))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">createTransient</span>(self, hostname, webhook_uri, secret):
        <span style="color:#e6db74">&#34;&#34;&#34;Creates a transient guest
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">        This example directly uses SooftLayer_Virtual_Guest::createObject, but using VSManager.order_guest()
</span><span style="color:#e6db74">        might be easier for most users.
</span><span style="color:#e6db74">        https://softlayer-api-python-client.readthedocs.io/en/latest/api/managers/vs/#SoftLayer.managers.vs.VSManager.order_guest
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>

        domain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ibm.com&#39;</span> <span style="color:#75715e"># pick a domain</span>
        datacenter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dal13&#39;</span> <span style="color:#75715e"># pick a dc</span>
        os_keyname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;UBUNTU_LATEST_64&#39;</span> <span style="color:#75715e"># from options in printOS</span>
        pub_network_vlan_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">12345</span>
        pub_subnet_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">54321</span>
        pri_network_vlan_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">112233</span>
        pri_subnet_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">332211</span>
        sg_allow_all_tcp_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">999999</span>
        sg_allow_all_udp_id <span style="color:#f92672">=</span> <span style="color:#ae81ff">888888</span>
        post_install_uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://pastebin.com/raw/62wrEKuW&#39;</span> <span style="color:#75715e"># needs to be https to be executed</span>
        flavor_keyname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C1_1X1X100&#39;</span> <span style="color:#75715e"># from printFlavors</span>
        ssh_keys <span style="color:#f92672">=</span> [{<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#ae81ff">87634</span>}] <span style="color:#75715e"># ID of sshkey</span>

        <span style="color:#75715e"># https://sldn.softlayer.com/reference/datatypes/SoftLayer_Virtual_Guest/</span>
        template <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#39;hostname&#39;</span>: hostname,
            <span style="color:#e6db74">&#39;domain&#39;</span>: domain,
            <span style="color:#e6db74">&#39;datacenter&#39;</span>: {<span style="color:#e6db74">&#39;name&#39;</span>:datacenter}, 
            <span style="color:#e6db74">&#39;hourlyBillingFlag&#39;</span>: True, <span style="color:#75715e"># Has to be True for transient</span>
            <span style="color:#e6db74">&#39;operatingSystemReferenceCode&#39;</span>: os_keyname,
            <span style="color:#e6db74">&#39;networkComponents&#39;</span>: [{<span style="color:#e6db74">&#39;maxSpeed&#39;</span>:<span style="color:#ae81ff">1000</span>}], <span style="color:#75715e"># 10, 100, 1000</span>
            <span style="color:#e6db74">&#39;blockDevices&#39;</span>: [
                {<span style="color:#e6db74">&#39;device&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;diskImage&#39;</span>: {<span style="color:#e6db74">&#39;capacity&#39;</span>: <span style="color:#ae81ff">30</span>}} <span style="color:#75715e"># optional additional disks.</span>
            ],
            <span style="color:#e6db74">&#39;sshKeys&#39;</span>: ssh_keys, 
            <span style="color:#75715e"># https://sldn.softlayer.com/reference/datatypes/SoftLayer_Virtual_Guest_SupplementalCreateObjectOptions/</span>
            <span style="color:#e6db74">&#39;supplementalCreateObjectOptions&#39;</span>: {
                <span style="color:#e6db74">&#39;flavorKeyName&#39;</span>: flavor_keyname,
                <span style="color:#e6db74">&#39;postInstallScriptUri&#39;</span>:  post_install_uri 
            },
            <span style="color:#e6db74">&#39;transientGuestFlag&#39;</span>: True,
            <span style="color:#e6db74">&#39;primaryBackendNetworkComponent&#39;</span> : {
                <span style="color:#e6db74">&#39;networkVlan&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pri_network_vlan_id, <span style="color:#e6db74">&#39;primarySubnet&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pri_subnet_id}}
            },
            <span style="color:#e6db74">&#39;primaryNetworkComponent&#39;</span>: {
                <span style="color:#e6db74">&#39;networkVlan&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pub_network_vlan_id, <span style="color:#e6db74">&#39;primarySubnet&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: pub_subnet_id}},
                <span style="color:#e6db74">&#39;securityGroupBindings&#39;</span>: [
                    {<span style="color:#e6db74">&#39;securityGroup&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: sg_allow_all_tcp_id}}, {<span style="color:#e6db74">&#39;securityGroup&#39;</span>: {<span style="color:#e6db74">&#39;id&#39;</span>: sg_allow_all_udp_id}}
                ]
            },
            <span style="color:#e6db74">&#39;userData&#39;</span>: [{<span style="color:#e6db74">&#39;value&#39;</span>:<span style="color:#e6db74">&#34;Just some random data, you can put anything here you want!&#34;</span>}]
        }

        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;createObject&#39;</span>, template)
        pp(result)
        <span style="color:#75715e"># Webhook HAS to be set AFTER the guest is created.</span>
        self<span style="color:#f92672">.</span>setWebHook(result[<span style="color:#e6db74">&#39;id&#39;</span>], webhook_uri, secret)
        <span style="color:#66d9ef">return</span> result
        


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setWebHook</span>(self, guest_id, url, secret):
        <span style="color:#e6db74">&#34;&#34;&#34;Sets the webhook&#34;&#34;&#34;</span>
        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;setTransientWebhook&#39;</span>, url, secret, id<span style="color:#f92672">=</span>guest_id)
        pp(result)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWebHook</span>(self, guest_id):
        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;getTransientWebhookURI&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        pp(result)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">delWebHook</span>(self, guest_id):
        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;deleteTransientWebhook&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        pp(result)


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testWebHook</span>(self, guest_id):
        <span style="color:#e6db74">&#34;&#34;&#34;Will send a test reclaim message to the TransientWebhookURI
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">        SoftLayer_Virtual_Guest::sendTestReclaimScheduledAlert return None
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        <span style="color:#66d9ef">try</span>:
            self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>, <span style="color:#e6db74">&#39;sendTestReclaimScheduledAlert&#39;</span>, id<span style="color:#f92672">=</span>guest_id)
        <span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>SoftLayerAPIError:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{} doesn&#39;t have a webhook set!&#34;</span><span style="color:#f92672">.</span>format(guest_id))


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">debug</span>(self):
        <span style="color:#66d9ef">for</span> call <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>get_last_calls():
            <span style="color:#66d9ef">print</span>(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>print_reproduceable(call))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">randomString</span>(self, stringLength<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>):
        <span style="color:#e6db74">&#34;&#34;&#34;Generate a random string of fixed length &#34;&#34;&#34;</span>
        letters <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_lowercase
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(random<span style="color:#f92672">.</span>choice(letters) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(stringLength))

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    webhook_uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://169.62.147.163/tesdfdsfst&#39;</span>
    secret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;MySecret123&#39;</span>
    hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TRX{}&#34;</span><span style="color:#f92672">.</span>format(main<span style="color:#f92672">.</span>randomString(<span style="color:#ae81ff">12</span>))
    
    main <span style="color:#f92672">=</span> transient()
    main<span style="color:#f92672">.</span>transientOptions()
    
    guest <span style="color:#f92672">=</span> main<span style="color:#f92672">.</span>createTransient(hostname, webhook_uri, secret)
    guest_id <span style="color:#f92672">=</span> guest[<span style="color:#e6db74">&#39;id&#39;</span>]

    main<span style="color:#f92672">.</span>setWebHook(guest_id, webhook_uri, secret)
    main<span style="color:#f92672">.</span>getWebHook(guest_id)
    main<span style="color:#f92672">.</span>testWebHook(guest_id)
    main<span style="color:#f92672">.</span>debug()
</code></pre></div>
            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20article%20-%20Transient%20Guests&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2farticle%2fTransientGuests%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

